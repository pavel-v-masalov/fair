insert into DM.LEASROUTING_MODELS
(
    SNAPSHOT_DT,
    ACCOUNTID,
    CREATEDON,
    EMAILADDRESS1,
    INDUSTRYCODENAME,
    ORGNAME,
    NEW_ACCOUNTINDUCTRYNAME,
    NEW_BLACK_LIST_DATE,
    NEW_CEOCHANGENAME,
    NEW_CHEKVERIFICATION,
    NEW_COMPANYSITE,
    NEW_EXPLOITATIONPL1,
    NEW_INCIDENTSOURCENAME,
    NEW_INN,
    NEW_KY_CUSTOMER,
    NEW_KY_SPESHLPR,
    NEW_LEGALORGANIZATIONALFORMNAM,
    NEW_MOBILEPHONE,
    NEW_OGRN,
    NEW_OKVEDIDNAME,
    NEW_PHYSICALINN,
    NEW_REGISTRATIONADDRESS,
    NEW_REGISTRATIONDATE,
    PRIMARYCONTACTID,
    PRIMARYCONTACTIDNAME,
    WEBSITEURL,
    RELGROUPS,
    RELMAX,
    NEW_AGENTID,
    NEW_ALLEXPRETISETASKSCLOSED,
    NEW_APPROVALRESULTNAME,
    NEW_FACTADRESS,
    NEW_LEASAGREEMENTCONDCONFIRMED,
    NEW_NONFINANCIAL,
    NEW_OPT,
    NEW_PODPRODUCTNAME,
    NEW_PRODUCTIDNAME,
    NEW_PROPERTYRISK,
    new_count,
    NEW_ROUTINGBYMODEL,
    NEW_STATUSCODEIDNAME,
    NEW_TOTALFINANCINGSUM,
    NEW_TOTALFINANCINGSUM_EXPRESS,
    NEW_TOTALSUMDEALPERIOD,
    NEW_ACCOUNTGROUPID,
    NEW_NAME,
    BIRTHDATE,
    CONTACTID,
    FIRSTNAME,
    GENDERCODENAME,
    JOBTITLE,
    MIDDLENAME,
    MOBILEPHONE,
    NEW_ADDRESS,
    NEW_CONTACTTYPENAME,
    VTBL_SCORINGSCORE,
    NEW_DOCNUMBER,
    NEW_DOCTYPE,
    NEW_DOCTYPENAME,
    NEW_SERIA,
    NEW_STARTDATE,
    NEW_WHENGIVE,
    NEW_WHOGIVE,
    LEADID,
    NEW_REF_ACCOUNTNAME,
    NEW_WEB,
    COUNTEDON,
    CREDITMODELISCOUNTABLE,
    FINANCESUM,
    CREDITMODELRESULT,
    NEW_FINANCESUM,
    FRAUDMODELRESULT,
    OPPORTUNITYCREDITRESULT,
    OPPORTUNITYFRAUDRESULT,
    PRODUCTOP,
    SCORINGSCORE,
    isPrescorig,
    MODEL_TYPE,
    calc_conditions,
    ISPRESCORINGCALL,
    model_settings
)
select
    null SNAPSHOT_DT
    ,a.ACCOUNTID
    ,a.CREATEDON
    ,a.EMAILADDRESS1
    ,a.INDUSTRYCODENAME
    ,a.NAME
    ,a.NEW_ACCOUNTINDUCTRYNAME
    ,a.NEW_BLACK_LIST_DATE
    ,a.NEW_CEOCHANGENAME
    ,a.NEW_CHEKVERIFICATION
    ,a.NEW_COMPANYSITE
    ,a.NEW_EXPLOITATIONPL1
    ,a.NEW_INCIDENTSOURCENAME
    ,a.NEW_INN
    ,a.NEW_KY_CUSTOMER
    ,a.NEW_KY_SPESHLPR
    ,a.NEW_LEGALORGANIZATIONALFORMNAM
    ,a.NEW_MOBILEPHONE
    ,a.NEW_OGRN
    ,a.NEW_OKVEDIDNAME
    ,a.NEW_PHYSICALINN
    ,a.NEW_REGISTRATIONADDRESS
    ,a.NEW_REGISTRATIONDATE
    ,a.PRIMARYCONTACTID
    ,a.PRIMARYCONTACTIDNAME
    ,a.WEBSITEURL
    ,rg.RELGROUPS
        ,rg.RELMAX
    ,o.NEW_AGENTID
        ,o.NEW_ALLEXPRETISETASKSCLOSED
        ,o.NEW_APPROVALRESULTNAME
        ,o.NEW_FACTADRESS
        ,o.NEW_LEASAGREEMENTCONDCONFIRMED
        ,o.NEW_NONFINANCIAL
        ,o.NEW_OPT
        ,o.NEW_PODPRODUCTNAME
        ,o.NEW_PRODUCTIDNAME
        ,o.NEW_PROPERTYRISK
        ,o.new_count
        ,o.NEW_ROUTINGBYMODEL
        ,o.NEW_STATUSCODEIDNAME
        ,o.NEW_TOTALFINANCINGSUM
        ,o.NEW_TOTALFINANCINGSUM_EXPRESS
        ,o.NEW_TOTALSUMDEALPERIOD
    ,ag.NEW_ACCOUNTGROUPID
        ,ag.NEW_NAME
    ,c.BIRTHDATE
    ,c.CONTACTID
    ,c.FIRSTNAME
    ,c.GENDERCODENAME
    ,c.JOBTITLE
    ,c.MIDDLENAME
    ,c.MOBILEPHONE
    ,c.NEW_ADDRESS
    ,c.NEW_CONTACTTYPENAME
    ,c.VTBL_SCORINGSCORE
    ,hd.NEW_DOCNUMBER
    ,hd.NEW_DOCTYPE
    ,hd.NEW_DOCTYPENAME
    ,hd.NEW_SERIA
    ,hd.NEW_STARTDATE
    ,hd.NEW_WHENGIVE
    ,hd.NEW_WHOGIVE
    ,l.LEADID
        ,l.NEW_REF_ACCOUNTNAME
        ,l.NEW_WEB
    ,r.COUNTEDON
        ,r.CREDITMODELISCOUNTABLE
        ,r.FINANCESUM
        ,r.CREDITMODELRESULT
        ,r.NEW_FINANCESUM
        ,r.FRAUDMODELRESULT
        ,r.OPPORTUNITYCREDITRESULT
        ,r.OPPORTUNITYFRAUDRESULT
        ,r.PRODUCTOP
        ,r.SCORINGSCORE
        ,r.isPrescorig
        ,r.MODEL_TYPE
        ,r.calc_conditions
        ,r.ISPRESCORINGCALL
        ,r.model_settings
from DWH.LEASROUTING_RMD_TMP r
left outer join DWH.LEASROUTING_OPPORTUNITY_TMP o on r.opportunityid = o.opportunityid and r.countedon = o.countedon
left outer join DWH.LEASROUTING_ACCOUNT_TMP a on  r.opportunityid = a.opportunityid and r.countedon = a.countedon
left outer join DWH.LEASROUTING_RELLGROUP_TMP rg on r.opportunityid = rg.opportunityid and r.countedon = rg.countedon
left outer join DWH.LEASROUT_NEW_ACCOUNTGROUP_TMP ag on r.opportunityid = ag.opportunityid and r.countedon = ag.countedon
left outer join DWH.LEASROUTING_CONTACT_TMP c on r.opportunityid = c.opportunityid and r.countedon = c.countedon
left outer join DWH.LEASROUTING_NEW_HUMANDOCS_TMP hd on r.opportunityid = hd.opportunityid and r.countedon = hd.countedon
left outer join DWH.LEASROUTING_CRM_LEAD_TMP l on r.opportunityid = l.opportunityid and r.countedon = l.countedon
;
